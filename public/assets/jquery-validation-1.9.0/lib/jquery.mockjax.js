/*!
 * MockJax - jQuery Plugin to Mock Ajax requests
 *
 * Version:  1.4.0
 * Released: 2011-02-04
 * Source:   http://github.com/appendto/jquery-mockjax
 * Docs:     http://enterprisejquery.com/2010/07/mock-your-ajax-requests-with-mockjax-for-rapid-development
 * Plugin:   mockjax
 * Author:   Jonathan Sharp (http://jdsharp.com)
 * License:  MIT,GPL
 * 
 * Copyright (c) 2010 appendTo LLC.
 * Dual licensed under the MIT or GPL licenses.
 * http://appendto.com/open-source-licenses
 */
!function(e){function t(t){void 0==window.DOMParser&&window.ActiveXObject&&(DOMParser=function(){},DOMParser.prototype.parseFromString=function(e){var t=new ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t});try{var n=(new DOMParser).parseFromString(t,"text/xml");if(!e.isXMLDoc(n))throw"Unable to parse XML";var r=e("parsererror",n);if(1==r.length)throw"Error: "+e(n).text()}catch(i){var a=void 0==i.name?i:i.name+": "+i.message;return e(document).trigger("xmlParseError",[a]),void 0}return n}var n=e.ajax,r=[];e.extend({ajax:function(i){var a=jQuery.extend(!0,{},jQuery.ajaxSettings,i),o=!1;return e.each(r,function(s){function l(){a.success&&a.success.call(x,d.response?d.response.toString():d.responseText||"",status,{}),a.global&&u("ajaxSuccess",[{},a])}function c(){a.complete&&a.complete.call(x,{},status),a.global&&u("ajaxComplete",[{},a]),a.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop")}function u(e,t){(a.context?jQuery(a.context):jQuery.event).trigger(e,t)}if(r[s]){var d=null;if(e.isFunction(r[s]))d=r[s](a);else{if(d=r[s],e.isFunction(d.url.test))d.url.test(a.url)||(d=null);else{var f=d.url.indexOf("*");("*"!=d.url&&d.url!=a.url&&-1==f||f>-1&&d.url.substr(0,f)!=a.url.substr(0,f))&&(d=null)}if(d){if(d.data&&a.data){var h=!1;!function w(t,n){return"string"==typeof n?h=e.isFunction(t.test)?t.test(n):t==n:(e.each(t,function(r){return void 0===n[r]?(h=!1,!1):(h=!0,"object"==typeof n[r]?w(t[r],n[r]):h=e.isFunction(t[r].test)?t[r].test(n[r]):t[r]==n[r])}),void 0)}(d.data,a.data),0==h&&(d=null)}d&&d.type&&d.type!=a.type&&(d=null)}}if(d){o=!0;var p=e.extend({},e.mockjaxSettings,d);p.log&&e.isFunction(p.log)&&p.log("MOCK "+a.type.toUpperCase()+": "+a.url,e.extend({},a));var m=/=\?(&|$)/,g=(new Date).getTime();"jsonp"===a.dataType&&("GET"===a.type.toUpperCase()?m.test(a.url)||(a.url+=(rquery.test(a.url)?"&":"?")+(a.jsonp||"callback")+"=?"):a.data&&m.test(a.data)||(a.data=(a.data?a.data+"&":"")+(a.jsonp||"callback")+"=?"),a.dataType="json"),"json"===a.dataType&&(a.data&&m.test(a.data)||m.test(a.url))&&(jsonp=a.jsonpCallback||"jsonp"+g++,a.data&&(a.data=(a.data+"").replace(m,"="+jsonp+"$1")),a.url=a.url.replace(m,"="+jsonp+"$1"),a.dataType="script",window[jsonp]=window[jsonp]||function(e){data=e,l(),c(),window[jsonp]=void 0;try{delete window[jsonp]}catch(t){}head&&head.removeChild(script)});var v=/^(\w+:)?\/\/([^\/?#]+)/,y=v.exec(a.url),b=y&&(y[1]&&y[1]!==location.protocol||y[2]!==location.host);if("script"===a.dataType&&"GET"===a.type.toUpperCase()&&b){var x=i&&i.context||a;return d.response&&e.isFunction(d.response)?d.response(i):e.globalEval(d.responseText),l(),c(),!1}return o=n.call(e,e.extend(!0,{},i,{xhr:function(){return d=e.extend({},e.mockjaxSettings,d),d.contentType&&(d.headers["content-type"]=d.contentType),{status:d.status,readyState:1,open:function(){},send:function(){var r=function(n){return function(){return function(){this.status=d.status,this.readyState=4,e.isFunction(d.response)&&d.response(i),"json"==a.dataType&&"object"==typeof d.responseText?this.responseText=JSON.stringify(d.responseText):"xml"==a.dataType?this.responseXML="string"==typeof d.responseXML?t(d.responseXML):d.responseXML:this.responseText=d.responseText,e.isFunction(this.onreadystatechange)&&this.onreadystatechange(d.isTimeout?"timeout":void 0)}.apply(n)}}(this);d.proxy?n({global:!1,url:d.proxy,type:d.proxyType,data:d.data,dataType:a.dataType,complete:function(e){d.responseXML=e.responseXML,d.responseText=e.responseText,this.responseTimer=setTimeout(r,d.responseTime||0)}}):a.async===!1?r():this.responseTimer=setTimeout(r,d.responseTime||50)},abort:function(){clearTimeout(this.responseTimer)},setRequestHeader:function(){},getResponseHeader:function(e){return d.headers&&d.headers[e]?d.headers[e]:"last-modified"==e.toLowerCase()?d.lastModified||(new Date).toString():"etag"==e.toLowerCase()?d.etag||"":"content-type"==e.toLowerCase()?d.contentType||"text/plain":void 0},getAllResponseHeaders:function(){var t="";return e.each(d.headers,function(e,n){t+=e+": "+n+"\n"}),t}}}})),!1}}}),o?o:n.apply(e,arguments)}}),e.mockjaxSettings={log:function(e){window.console&&window.console.log&&window.console.log(e)},status:200,responseTime:500,isTimeout:!1,contentType:"text/plain",response:"",responseText:"",responseXML:"",proxy:"",proxyType:"GET",lastModified:null,etag:"",headers:{etag:"IJF@H#@923uf8023hFO@I#H#","content-type":"text/plain"}},e.mockjax=function(e){var t=r.length;return r[t]=e,t},e.mockjaxClear=function(e){1==arguments.length?r[e]=null:r=[]}}(jQuery);