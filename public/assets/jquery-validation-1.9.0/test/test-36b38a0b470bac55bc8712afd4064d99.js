window.sessionStorage&&sessionStorage.clear(),jQuery.validator.defaults.debug=!0,$.mockjaxSettings.log=$.noop,$.mockjax({url:"form.php?user=Peter&password=foobar",responseText:"Hi Peter, welcome back.",responseStatus:200,responseTime:1}),$.mockjax({url:"users.php",data:{username:/Peter2?|asdf/},responseText:"false",responseStatus:200,responseTime:1}),$.mockjax({url:"users2.php",data:{username:"asdf"},responseText:'"asdf is already taken, please try something else"',responseStatus:200,responseTime:1}),module("validator"),test("Constructor",function(){var e=$("#testForm1").validate(),t=$("#testForm1").validate();equals(e,t,"Calling validate() multiple times must return the same validator instance"),equals(e.elements().length,3,"validator elements")}),test("validate() without elements, with non-form elements",function(){$("#doesn'texist").validate()}),test("valid() plugin method",function(){var e=$("#userForm");e.validate(),ok(!e.valid(),"Form isn't valid yet");var t=$("#username");ok(!t.valid(),"Input isn't valid either"),t.val("Hello world"),ok(e.valid(),"Form is now valid"),ok(t.valid(),"Input is valid, too")}),test("valid() plugin method",function(){var e=$("#testForm1");e.validate();var t=e.find("input");ok(!t.valid(),"all invalid"),t.not(":first").val("ok"),ok(!t.valid(),"just one invalid"),t.val("ok"),ok(t.valid(),"all valid")}),test("valid() plugin method, special handling for checkable groups",function(){var e=$("#checkable2");ok(!e.valid(),"must be invalid, not checked yet"),e.attr("checked",!0),ok(e.valid(),"valid, is now checked"),e.attr("checked",!1),ok(!e.valid(),"invalid again"),$("#checkable3").attr("checked",!0),ok(e.valid(),"valid, third box is checked")}),test("addMethod",function(){expect(3),$.validator.addMethod("hi",function(e){return"hi"==e},"hi me too");var e=$.validator.methods.hi,t=$("#text1")[0];ok(!e(t.value,t),"Invalid"),t.value="hi",ok(e(t.value,t),"Invalid"),ok("hi me too"==jQuery.validator.messages.hi,"Check custom message")}),test("addMethod2",function(){expect(4),$.validator.addMethod("complicatedPassword",function(e,t){return this.optional(t)||/\D/.test(e)&&/\d/.test(e)},"Your password must contain at least one number and one letter");var e=jQuery("#form").validate({rules:{action:{complicatedPassword:!0}}}),t=($.validator.methods.complicatedPassword,$("#text1")[0]);t.value="",ok(void 0===e.element(t),"Rule is optional, valid"),equals(0,e.size()),t.value="ko",ok(!e.element(t),"Invalid, doesn't contain one of the required characters"),t.value="ko1",ok(e.element(t))}),test("form(): simple",function(){expect(2);var e=$("#testForm1")[0],t=$(e).validate();ok(!t.form(),"Invalid form"),$("#firstname").val("hi"),$("#lastname").val("hi"),ok(t.form(),"Valid form")}),test("form(): checkboxes: min/required",function(){expect(3);var e=$("#testForm6")[0],t=$(e).validate();ok(!t.form(),"Invalid form"),$("#form6check1").attr("checked",!0),ok(!t.form(),"Invalid form"),$("#form6check2").attr("checked",!0),ok(t.form(),"Valid form")}),test("form(): radio buttons: required",function(){expect(6);var e=$("#testForm10")[0],t=$(e).validate({rules:{testForm10Radio:"required"}});ok(!t.form(),"Invalid Form"),equals($("#testForm10Radio1").attr("class"),"error"),equals($("#testForm10Radio2").attr("class"),"error"),$("#testForm10Radio2").attr("checked",!0),ok(t.form(),"Valid form"),equals($("#testForm10Radio1").attr("class"),"valid"),equals($("#testForm10Radio2").attr("class"),"valid")}),test("form(): selects: min/required",function(){expect(3);var e=$("#testForm7")[0],t=$(e).validate();ok(!t.form(),"Invalid form"),$("#optionxa").attr("selected",!0),ok(!t.form(),"Invalid form"),$("#optionxb").attr("selected",!0),ok(t.form(),"Valid form")}),test("form(): with equalTo",function(){expect(2);var e=$("#testForm5")[0],t=$(e).validate();ok(!t.form(),"Invalid form"),$("#x1, #x2").val("hi"),ok(t.form(),"Valid form")}),test("check(): simple",function(){expect(3);var e=$("#firstname")[0],t=$("#testForm1").validate();ok(0==t.size(),"No errors yet"),t.check(e),ok(1==t.size(),"error exists"),t.errorList=[],$("#firstname").val("hi"),t.check(e),ok(1==!t.size(),"No more errors")}),test("hide(): input",function(){expect(3);var e=$("#errorFirstname"),t=$("#firstname")[0];t.value="bla";var n=$("#testForm1").validate();e.show(),ok(e.is(":visible"),"Error label visible before validation"),ok(n.element(t)),ok(e.is(":hidden"),"Error label not visible after validation")}),test("hide(): radio",function(){expect(2);var e=$("#agreeLabel"),t=$("#agb")[0];t.checked=!0;var n=$("#testForm2").validate({errorClass:"xerror"});e.show(),ok(e.is(":visible"),"Error label visible after validation"),n.element(t),ok(e.is(":hidden"),"Error label not visible after hiding it")}),test("hide(): errorWrapper",function(){expect(2);var e=$("#errorWrapper"),t=$("#meal")[0];t.selectedIndex=1,e.show(),ok(e.is(":visible"),"Error label visible after validation");var n=$("#testForm3").validate({wrapper:"li",errorLabelContainer:$("#errorContainer")});n.element(t),ok(e.is(":hidden"),"Error label not visible after hiding it")}),test("hide(): container",function(){expect(4);var e=$("#errorContainer"),t=($("#testForm3")[0],$("#testForm3").validate({errorWrapper:"li",errorContainer:$("#errorContainer")}));t.form(),ok(e.is(":visible"),"Error label visible after validation"),$("#meal")[0].selectedIndex=1,t.form(),ok(e.is(":hidden"),"Error label not visible after hiding it"),$("#meal")[0].selectedIndex=-1,t.element("#meal"),ok(e.is(":visible"),"Error label visible after validation"),$("#meal")[0].selectedIndex=1,t.element("#meal"),ok(e.is(":hidden"),"Error label not visible after hiding it")}),test("valid()",function(){expect(4);var e=[{name:"meal",message:"foo",element:$("#meal")[0]}],t=$("#testForm3").validate();ok(t.valid(),"No errors, must be valid"),t.errorList=e,ok(!t.valid(),"One error, must be invalid"),QUnit.reset(),t=$("#testForm3").validate({submitHandler:function(){ok(!1,"Submit handler was called")}}),ok(t.valid(),"No errors, must be valid and returning true, even with the submit handler"),t.errorList=e,ok(!t.valid(),"One error, must be invalid, no call to submit handler")}),test("submitHandler keeps submitting button",function(){$("#userForm").validate({debug:!0,submitHandler:function(t){var n=$(t).find("input:hidden")[0];same(n.value,e.value),same(n.name,e.name)}}),$("#username").val("bla");var e=$("#userForm :submit")[0];$(e).triggerHandler("click"),$("#userForm").submit()}),test("showErrors()",function(){expect(4);var e=$("#errorFirstname").hide(),t=($("#firstname")[0],$("#testForm1").validate());ok(e.is(":hidden")),equals(0,$("label.error[for=lastname]").size()),t.showErrors({firstname:"required",lastname:"bla"}),equals(!0,e.is(":visible")),equals(!0,$("label.error[for=lastname]").is(":visible"))}),test("showErrors(), allow empty string and null as default message",function(){$("#userForm").validate({rules:{username:{required:!0,minlength:3}},messages:{username:{required:"",minlength:"too short"}}}),ok(!$("#username").valid()),equals("",$("label.error[for=username]").text()),$("#username").val("ab"),ok(!$("#username").valid()),equals("too short",$("label.error[for=username]").text()),$("#username").val("abc"),ok($("#username").valid()),ok($("label.error[for=username]").is(":hidden"))}),test("showErrors() - external messages",function(){expect(4);var e=$.extend({},$.validator.methods),t=$.extend({},$.validator.messages);$.validator.addMethod("foo",function(){return!1}),$.validator.addMethod("bar",function(){return!1}),equals(0,$("#testForm4 label.error[for=f1]").size()),equals(0,$("#testForm4 label.error[for=f2]").size());var n=$("#testForm4")[0],r=$(n).validate({messages:{f1:"Please!",f2:"Wohoo!"}});r.form(),equals($("#testForm4 label.error[for=f1]").text(),"Please!"),equals($("#testForm4 label.error[for=f2]").text(),"Wohoo!"),$.validator.methods=e,$.validator.messages=t}),test("showErrors() - custom handler",function(){expect(5);var e=$("#testForm1").validate({showErrors:function(t,n){equals(e,this),equals(e.errorList,n),equals(e.errorMap,t),equals("buga",t.firstname),equals("buga",t.lastname)}});e.form()}),test("option: (un)highlight, default",function(){$("#testForm1").validate();var e=$("#firstname");ok(!e.hasClass("error")),ok(!e.hasClass("valid")),e.valid(),ok(e.hasClass("error")),ok(!e.hasClass("valid")),e.val("hithere").valid(),ok(!e.hasClass("error")),ok(e.hasClass("valid"))}),test("option: (un)highlight, nothing",function(){expect(3),$("#testForm1").validate({highlight:!1,unhighlight:!1});var e=$("#firstname");ok(!e.hasClass("error")),e.valid(),ok(!e.hasClass("error")),e.valid(),ok(!e.hasClass("error"))}),test("option: (un)highlight, custom",function(){expect(5),$("#testForm1clean").validate({highlight:function(e,t){equals("invalid",t),$(e).hide()},unhighlight:function(e,t){equals("invalid",t),$(e).show()},errorClass:"invalid",rules:{firstname:"required"}});var e=$("#firstnamec");ok(e.is(":visible")),e.valid(),ok(!e.is(":visible")),e.val("hithere").valid(),ok(e.is(":visible"))}),test("option: (un)highlight, custom2",function(){expect(6),$("#testForm1").validate({highlight:function(e,t){$(e).addClass(t),$(e.form).find("label[for="+e.id+"]").addClass(t)},unhighlight:function(e,t){$(e).removeClass(t),$(e.form).find("label[for="+e.id+"]").removeClass(t)},errorClass:"invalid"});var e=$("#firstname"),t=$("#errorFirstname");ok(!e.is(".invalid")),ok(!t.is(".invalid")),e.valid(),ok(e.is(".invalid")),ok(t.is(".invalid")),e.val("hithere").valid(),ok(!e.is(".invalid")),ok(!t.is(".invalid"))}),test("option: focusCleanup default false",function(){var e=$("#userForm");e.validate(),e.valid(),ok(e.is(":has(label.error[for=username]:visible)")),$("#username").focus(),ok(e.is(":has(label.error[for=username]:visible)"))}),test("option: focusCleanup true",function(){var e=$("#userForm");e.validate({focusCleanup:!0}),e.valid(),ok(e.is(":has(label.error[for=username]:visible)")),$("#username").focus().trigger("focusin"),ok(!e.is(":has(label.error[for=username]:visible)"))}),test("option: focusCleanup with wrapper",function(){var e=$("#userForm");e.validate({focusCleanup:!0,wrapper:"span"}),e.valid(),ok(e.is(":has(span:visible:has(label.error[for=username]))")),$("#username").focus().trigger("focusin"),ok(!e.is(":has(span:visible:has(label.error[for=username]))"))}),test("elements() order",function(){var e=$("#orderContainer"),t=$("#elementsOrder").validate({errorLabelContainer:e,wrap:"li"});deepEqual(t.elements().map(function(){return $(this).attr("id")}).get(),["order1","order2","order3","order4","order5","order6"],"elements must be in document order"),t.form(),deepEqual(e.children().map(function(){return $(this).attr("for")}).get(),["order1","order2","order3","order4","order5","order6"],"labels in error container must be in document order")}),test("defaultMessage(), empty title is ignored",function(){var e=$("#userForm").validate();equals("This field is required.",e.defaultMessage($("#username")[0],"required"))}),test("formatAndAdd",function(){expect(4);var e=$("#form").validate(),t={form:$("#form")[0],name:"bar"};e.formatAndAdd(t,{method:"maxlength",parameters:2}),equals("Please enter no more than 2 characters.",e.errorList[0].message),equals("bar",e.errorList[0].element.name),e.formatAndAdd(t,{method:"range",parameters:[2,4]}),equals("Please enter a value between 2 and 4.",e.errorList[1].message),e.formatAndAdd(t,{method:"range",parameters:[0,4]}),equals("Please enter a value between 0 and 4.",e.errorList[2].message)}),test("formatAndAdd2",function(){expect(3);var e=$("#form").validate(),t={form:$("#form")[0],name:"bar"};jQuery.validator.messages.test1=function(t,n){return equals(e,this),equals(0,t),"element "+n.name+" is not valid"},e.formatAndAdd(t,{method:"test1",parameters:0}),equals("element bar is not valid",e.errorList[0].message)}),test("formatAndAdd, auto detect substitution string",function(){var e=$("#testForm1clean").validate({rules:{firstname:{required:!0,rangelength:[5,10]}},messages:{firstname:{rangelength:"at least ${0}, up to {1}"}}});$("#firstnamec").val("abc"),e.form(),equals("at least 5, up to 10",e.errorList[0].message)}),test("error containers, simple",function(){expect(14);var e=$("#simplecontainer"),t=$("#form").validate({errorLabelContainer:e,showErrors:function(){e.find("h3").html(jQuery.validator.format("There are {0} errors in your form.",this.size())),this.defaultShowErrors()}});t.prepareForm(),ok(t.valid(),"form is valid"),equals(0,e.find("label").length,"There should be no error labels"),equals("",e.find("h3").html()),t.prepareForm(),t.errorList=[{message:"bar",element:{name:"foo"}},{message:"necessary",element:{name:"required"}}],ok(!t.valid(),"form is not valid after adding errors manually"),t.showErrors(),equals(e.find("label").length,2,"There should be two error labels"),ok(e.is(":visible"),"Check that the container is visible"),e.find("label").each(function(){ok($(this).is(":visible"),"Check that each label is visible")}),equals("There are 2 errors in your form.",e.find("h3").html()),t.prepareForm(),ok(t.valid(),"form is valid after a reset"),t.showErrors(),equals(e.find("label").length,2,"There should still be two error labels"),ok(e.is(":hidden"),"Check that the container is hidden"),e.find("label").each(function(){ok($(this).is(":hidden"),"Check that each label is hidden")})}),test("error containers, with labelcontainer I",function(){expect(16);var e=$("#container"),t=$("#labelcontainer"),n=$("#form").validate({errorContainer:e,errorLabelContainer:t,wrapper:"li"});ok(n.valid(),"form is valid"),equals(0,e.find("label").length,"There should be no error labels in the container"),equals(0,t.find("label").length,"There should be no error labels in the labelcontainer"),equals(0,t.find("li").length,"There should be no lis labels in the labelcontainer"),n.errorList=[{message:"bar",element:{name:"foo"}},{name:"required",message:"necessary",element:{name:"required"}}],ok(!n.valid(),"form is not valid after adding errors manually"),n.showErrors(),equals(0,e.find("label").length,"There should be no error label in the container"),equals(2,t.find("label").length,"There should be two error labels in the labelcontainer"),equals(2,t.find("li").length,"There should be two error lis in the labelcontainer"),ok(e.is(":visible"),"Check that the container is visible"),ok(t.is(":visible"),"Check that the labelcontainer is visible");t.find("label").each(function(){ok($(this).is(":visible"),"Check that each label is visible1"),equals("li",$(this).parent()[0].tagName.toLowerCase(),"Check that each label is wrapped in an li"),ok($(this).parent("li").is(":visible"),"Check that each parent li is visible")})}),test("errorcontainer, show/hide only on submit",function(){expect(14);var e=$("#container"),t=$("#labelcontainer"),n=$("#testForm1").bind("invalid-form.validate",function(){ok(!0,"invalid-form event triggered called")}).validate({errorContainer:e,errorLabelContainer:t,showErrors:function(){e.html(jQuery.validator.format("There are {0} errors in your form.",this.numberOfInvalids())),ok(!0,"showErrors called"),this.defaultShowErrors()}});equals("",e.html(),"must be empty"),equals("",t.html(),"must be empty"),ok(!n.form(),"invalid form"),equals(2,t.find("label").length),equals("There are 2 errors in your form.",e.html()),ok(t.is(":visible"),"must be visible"),ok(e.is(":visible"),"must be visible"),$("#firstname").val("hix").keyup(),$("#testForm1").triggerHandler("keyup",[jQuery.event.fix({type:"keyup",target:$("#firstname")[0]})]),equals(1,t.find("label:visible").length),equals("There are 1 errors in your form.",e.html()),$("#lastname").val("abc"),ok(n.form(),"Form now valid, trigger showErrors but not invalid-form")}),test("option invalidHandler",function(){expect(1);$("#testForm1clean").validate({invalidHandler:function(){ok(!0,"invalid-form event triggered called"),start()}});$("#usernamec").val("asdf").rules("add",{required:!0,minlength:5}),stop(),$("#testForm1clean").submit()}),test("findByName()",function(){deepEqual(new $.validator({},document.getElementById("form")).findByName(document.getElementById("radio1").name).get(),$("#form").find("[name=radio1]").get())}),test("focusInvalid()",function(){var e=$("#testForm1 input").focus(function(){equals(e[0],this,"focused first element")}),t=$("#testForm1").validate();t.form(),t.focusInvalid()}),test("findLastActive()",function(){expect(3);var e=$("#testForm1").validate();ok(!e.findLastActive()),e.form(),e.focusInvalid(),equals(e.findLastActive(),$("#firstname")[0]);var t=$("#lastname").trigger("focus").trigger("focusin")[0];equals(e.lastActive,t)}),test("validating multiple checkboxes with 'required'",function(){expect(3);var e=$("#form input[name=check3]").attr("checked",!1);equal(e.size(),5);var t=$("#form").validate({rules:{check3:"required"}});t.form(),equal(t.size(),1),e.filter(":last").attr("checked",!0),t.form(),equal(t.size(),0)}),test("dynamic form",function(){function e(){$("<input class='{required:true}' name='list"+n++ +"' />").appendTo("#testForm2")}function t(e,t){equals(e,r.size(),t)}var n=0,r=$("#testForm2").validate();r.form(),t(1),e(),r.form(),t(2),e(),r.form(),t(3),$("#testForm2 input[name=list1]").remove(),r.form(),t(2),e(),r.form(),t(3),$("#testForm2 input[name^=list]").remove(),r.form(),t(1),$("#agb").attr("disabled",!0),r.form(),t(0),$("#agb").attr("disabled",!1),r.form(),t(1)}),test("idOrName()",function(){expect(4);var e=$("#testForm1").validate();equals("form8input",e.idOrName($("#form8input")[0])),equals("check",e.idOrName($("#form6check1")[0])),equals("agree",e.idOrName($("#agb")[0])),equals("button",e.idOrName($("#form :button")[0]))}),test("resetForm()",function(){function e(e,n){equals(e,t.size(),n)}var t=$("#testForm1").validate();t.form(),e(2),$("#firstname").val("hiy"),t.resetForm(),e(0),equals("",$("#firstname").val(),"form plugin is included, therefor resetForm must also reset inputs, not only errors")}),test("message from title",function(){var e=$("#withTitle").validate();e.checkForm(),equals(e.errorList[0].message,"fromtitle","title not used")}),test("ignoreTitle",function(){var e=$("#withTitle").validate({ignoreTitle:!0});e.checkForm(),equals(e.errorList[0].message,$.validator.messages.required,"title used when it should have been ignored")}),test("ajaxSubmit",function(){expect(1),stop(),$("#user").val("Peter"),$("#password").val("foobar"),jQuery("#signupForm").validate({submitHandler:function(e){jQuery(e).ajaxSubmit({success:function(e){equals("Hi Peter, welcome back.",e),start()}})}}),jQuery("#signupForm").triggerHandler("submit")}),module("misc"),test("success option",function(){expect(7),equals("",$("#firstname").val());var e=$("#testForm1").validate({success:"valid"}),t=$("#testForm1 label");ok(t.is(".error")),ok(!t.is(".valid")),e.form(),ok(t.is(".error")),ok(!t.is(".valid")),$("#firstname").val("hi"),e.form(),ok(t.is(".error")),ok(t.is(".valid"))}),test("success option2",function(){expect(5),equals("",$("#firstname").val());var e=$("#testForm1").validate({success:"valid"}),t=$("#testForm1 label");ok(t.is(".error")),ok(!t.is(".valid")),$("#firstname").val("hi"),e.form(),ok(t.is(".error")),ok(t.is(".valid"))}),test("success option3",function(){expect(5),equals("",$("#firstname").val()),$("#errorFirstname").remove();var e=$("#testForm1").validate({success:"valid"});equals(0,$("#testForm1 label").size()),$("#firstname").val("hi"),e.form();var t=$("#testForm1 label");equals(3,t.size()),ok(t.eq(0).is(".valid")),ok(!t.eq(1).is(".valid"))}),test("successlist",function(){var e=$("#form").validate({success:"xyz"});e.form(),equals(0,e.successList.length)}),test("success isn't called for optional elements",function(){expect(4),equals("",$("#firstname").removeClass().val()),$("#something").remove(),$("#lastname").remove(),$("#errorFirstname").remove();var e=$("#testForm1").validate({success:function(){ok(!1,"don't call success for optional elements!")},rules:{firstname:"email"}});equals(0,$("#testForm1 label").size()),e.form(),equals(0,$("#testForm1 label").size()),$("#firstname").valid(),equals(0,$("#testForm1 label").size())}),test("all rules are evaluated even if one returns a dependency-mistmatch",function(){expect(6),equals("",$("#firstname").removeClass().val()),$("#lastname").remove(),$("#errorFirstname").remove(),$.validator.addMethod("custom1",function(){return ok(!0,"custom method must be evaluated"),!0},"");var e=$("#testForm1").validate({rules:{firstname:{email:!0,custom1:!0}}});equals(0,$("#testForm1 label").size()),e.form(),equals(0,$("#testForm1 label").size()),$("#firstname").valid(),equals(0,$("#testForm1 label").size()),delete $.validator.methods.custom1,delete $.validator.messages.custom1}),test("messages",function(){var e=jQuery.validator.messages;equals("Please enter no more than 0 characters.",e.maxlength(0)),equals("Please enter at least 1 characters.",e.minlength(1)),equals("Please enter a value between 1 and 2 characters long.",e.rangelength([1,2])),equals("Please enter a value less than or equal to 1.",e.max(1)),equals("Please enter a value greater than or equal to 0.",e.min(0)),equals("Please enter a value between 1 and 2.",e.range([1,2]))}),test("jQuery.validator.format",function(){equals("Please enter a value between 0 and 1.",jQuery.validator.format("Please enter a value between {0} and {1}.",0,1)),equals("0 is too fast! Enter a value smaller then 0 and at least -15",jQuery.validator.format("{0} is too fast! Enter a value smaller then {0} and at least {1}",0,-15));var e=jQuery.validator.format("{0} is too fast! Enter a value smaller then {0} and at least {1}");equals("0 is too fast! Enter a value smaller then 0 and at least -15",e(0,-15)),e=jQuery.validator.format("Please enter a value between {0} and {1}."),equals("Please enter a value between 1 and 2.",e([1,2]))}),test("option: ignore",function(){var e=$("#testForm1").validate({ignore:"[name=lastname]"});e.form(),equals(1,e.size())}),test("option: subformRequired",function(){jQuery.validator.addMethod("billingRequired",function(e,t){return $("#bill_to_co").is(":checked")?$(t).parents("#subform").length:!this.optional(t)},"");var e=$("#subformRequired").validate();e.form(),equals(1,e.size()),$("#bill_to_co").attr("checked",!1),e.form(),equals(2,e.size()),delete $.validator.methods.billingRequired,delete $.validator.messages.billingRequired}),module("expressions"),test("expression: :blank",function(){var e=$("#lastname")[0];equals(1,$(e).filter(":blank").length),e.value=" ",equals(1,$(e).filter(":blank").length),e.value="   ",equals(1,$(e).filter(":blank").length),e.value=" a ",equals(0,$(e).filter(":blank").length)}),test("expression: :filled",function(){var e=$("#lastname")[0];equals(0,$(e).filter(":filled").length),e.value=" ",equals(0,$(e).filter(":filled").length),e.value="   ",equals(0,$(e).filter(":filled").length),e.value=" a ",equals(1,$(e).filter(":filled").length)}),test("expression: :unchecked",function(){var e=$("#check2")[0];equals(1,$(e).filter(":unchecked").length),e.checked=!0,equals(0,$(e).filter(":unchecked").length),e.checked=!1,equals(1,$(e).filter(":unchecked").length)}),module("events"),test("validate on blur",function(){function e(e,t){equals(i.size(),e,t)}function t(e){equals(i.errors().filter(":visible").size(),e)}function n(e){e.trigger("blur").trigger("focusout")}$("#errorFirstname").hide();var r=$("#firstname"),i=$("#testForm1").validate();$("#something").val(""),n(r),e(0,"No value yet, required is skipped on blur"),t(0),r.val("h"),n(r),e(1,"Required was ignored, but as something was entered, check other rules, minlength isn't met"),t(1),r.val("hh"),n(r),e(0,"All is fine"),t(0),r.val(""),i.form(),e(3,"Submit checks all rules, both fields invalid"),t(3),n(r),e(1,"Blurring the field results in emptying the error list first, then checking the invalid field: its still invalid, don't remove the error"),t(3),r.val("h"),n(r),e(1,"Entering a single character fulfills required, but not minlength: 2, still invalid"),t(3),r.val("hh"),n(r),e(0,"Both required and minlength are met, no errors left"),t(2)}),test("validate on keyup",function(){function e(e,t){equals(e,r.size(),t)}function t(e){e.trigger("keyup")}var n=$("#firstname"),r=$("#testForm1").validate();t(n),e(0,"No value, no errors"),n.val("a"),t(n),e(0,"Value, but not invalid"),n.val(""),r.form(),e(2,"Both invalid"),t(n),e(1,"Only one field validated, still invalid"),n.val("hh"),t(n),e(0,"Not invalid anymore"),n.val("h"),t(n),e(1,"Field didn't loose focus, so validate again, invalid"),n.val("hh"),t(n),e(0,"Valid")}),test("validate on not keyup, only blur",function(){function e(e,t){equals(e,n.size(),t)}var t=$("#firstname"),n=$("#testForm1").validate({onkeyup:!1});e(0),t.val("a"),t.trigger("keyup"),t.keyup(),e(0),t.trigger("blur").trigger("focusout"),e(1)}),test("validate on keyup and blur",function(){function e(e,t){equals(e,n.size(),t)}var t=$("#firstname"),n=$("#testForm1").validate();e(0),t.val("a"),t.trigger("keyup"),e(0),t.trigger("blur").trigger("focusout"),e(1)}),test("validate email on keyup and blur",function(){function e(e,t){equals(e,n.size(),t)}var t=$("#firstname"),n=$("#testForm1").validate();n.form(),e(2),t.val("a"),t.trigger("keyup"),e(1),t.val("aa"),t.trigger("keyup"),e(0)}),test("validate checkbox on click",function(){function e(e,t){equals(e,r.size(),t)}function t(e){e.click(),e.valid()}var n=$("#check2"),r=$("#form").validate({rules:{check2:"required"}});t(n),e(0),t(n),equals(!1,r.form()),e(1),t(n),e(0),t(n),e(1)}),test("validate multiple checkbox on click",function(){function e(e,t){equals(e,i.size(),t)}function t(e){e.click(),e.valid()}var n=$("#check1").attr("checked",!1),r=$("#check1b"),i=$("#form").validate({rules:{check:{required:!0,minlength:2}}});t(n),t(r),e(0),t(r),equals(!1,i.form()),e(1),t(r),e(0),t(r),e(1)}),test("correct checkbox receives the error",function(){function e(e){e.click(),e.valid()}var t=$("#check1").attr("checked",!1),n=($("#check1b").attr("checked",!1),$("#form").find("[type=checkbox]").attr("checked",!1).end().validate({rules:{check:{required:!0,minlength:2}}}));equals(!1,n.form()),e(t),equals(!1,n.form()),ok(n.errorList[0].element.id===n.currentElements[0].id,"the proper checkbox has the error AND is present in currentElements")}),test("validate radio on click",function(){function e(e,t){equals(e,i.size(),t)}function t(e){e.click(),e.valid()}var n=$("#radio1"),r=$("#radio1a"),i=$("#form").validate({rules:{radio1:"required"}});e(0),equals(!1,i.form()),e(1),t(r),e(0),t(n),e(0)}),test("ignore hidden elements",function(){var e=$("#userForm"),t=e.validate({rules:{username:"required"}});e.get(0).reset(),ok(!t.form(),"form should be initially invalid"),$("#userForm [name=username]").hide(),ok(t.form(),"hidden elements should be ignored by default")}),test("ignore hidden elements at start",function(){var e=$("#userForm"),t=e.validate({rules:{username:"required"}});e.get(0).reset(),$("#userForm [name=username]").hide(),ok(t.form(),"hidden elements should be ignored by default"),$("#userForm [name=username]").show(),ok(!t.form(),"form should be invalid when required element is visible")});