function Fingerings_Canvas(e,t,n,r){function a(){o(),ctx.fillStyle="black",ctx.font="12pt Calibri",2>w&&"show"!=n&&s(),w>1&&"show"!=n&&c(),E&&l()}function o(){ctx.clearRect(0,0,canvas.width,canvas.height)}function s(){ctx.save(),S&&(ctx.fillStyle="rgb(255, 0, 0)"),ctx.fillText("Add Note to Fingering",8,canvas.height-20),ctx.restore()}function c(){ctx.save(),M&&(ctx.fillStyle="rgb(255, 0, 0)"),ctx.fillText("Remove Note from Fingering",8,canvas.height-5),ctx.restore()}function l(){ctx.save(),C&&ctx.drawImage(_,0,0),k&&(ctx.fillStyle="rgb(255, 0, 0)"),text=C?"To Fingering":"To Legend",ctx.fillText(text,8,canvas.height-40),ctx.restore()}function u(){canvas=document.createElement("canvas"),canvas.width=m_canvas.width,canvas.height=m_canvas.height,ctx=m_canvas.getContext("2d"),a(),C||f(),m_ctx.drawImage(canvas,0,0)}function f(){if(k=S=M=!1,E&&mouse_X>3&&90>mouse_X&&mouse_Y<canvas.height-35&&mouse_Y>canvas.height-55&&(k=!0),"show"!=n&&2>w&&mouse_X>3&&150>mouse_X&&mouse_Y<canvas.height-15&&mouse_Y>canvas.height-35&&(S=!0),"show"!=n&&w>1&&mouse_X>3&&200>mouse_X&&mouse_Y<canvas.height-5&&mouse_Y>canvas.height-15&&(M=!0),isMobile()||(k&&""==pointer?pointer="help":k||"help"!=pointer||(pointer=""),S&&""==pointer?pointer="add":S||"add"!=pointer||(pointer=""),M&&""==pointer?pointer="remove":M||"remove"!=pointer||(pointer="")),"show"==n||"new"==n||"edit"==n)ctx.save(),ctx.scale(scale_X,scale_Y),ctx.save(),w>=1&&y.Update(),ctx.restore(),ctx.save(),w>=2&&x.Update(),ctx.restore(),ctx.save(),w>=3&&b.Update(),ctx.restore(),ctx.restore();else if("note_search"==n){ctx.save(),ctx.scale(scale_X,scale_Y);for(var e=0;3>e;e++)ctx.save(),w>=e+1&&T[e].Update(),ctx.restore();ctx.restore()}else"fingering_search"==n&&alert("Not Implemeted in Fingerings_Canvas!")}function d(e){if(isMobile()&&(p(e),f()),k)N=!N,C=!C,ctx.canvas.width=C?600:w>1?200+200*scale_X*w:200*scale_X;else if(S){w++;var t="777777777777777777777777777777",r="f3",i="♮";if("edit"==n||"new"==n)switch(w){case 2:x=new Fingering_Chart(200,0,t,r,i,!1,"new");break;case 3:b=new Fingering_Chart(400,0,t,r,i,!1,"new")}else if("note_search"==n)switch(w){case 2:T[1]=new Note_Chart(200,0);break;case 3:T[2]=new Note_Chart(400,0)}ctx.canvas.width=200+200*scale_X*w}else M?(w--,ctx.canvas.width=1==w?200*scale_X:200+200*scale_X*w):"new"==n||"edit"==n?(w>=1&&y.OnClick(),w>=2&&x.OnClick(),w>=3&&b.OnClick()):"note_search"==n&&(w>=1&&T[0].OnClick(),w>=2&&T[1].OnClick(),w>=3&&T[2].OnClick())}function p(e){mouse_X=e.pageX-(m_canvas.offsetLeft+m_canvas.offsetParent.offsetLeft),mouse_Y=e.pageY-(m_canvas.offsetTop+m_canvas.offsetParent.offsetTop),isMobile()||(document.body.style.cursor=pointer?"pointer":"default")}function h(e){var t=new Array(w);return w>=1&&(t[0]=e.substring(2,32)),w>=2&&(t[1]=e.substring(33,63)),w>=3&&(t[2]=e.substring(64,94)),t}function m(e){var t=new Array(w),n=new Array(w),r=e.substring(2);return n=r.split(","),w>=1&&(t[0]=n[0].substring(0,2)),w>=2&&(t[1]=n[1].substring(0,2)),w>=3&&(t[2]=n[2].substring(0,2)),t}function g(e){var t=new Array(w),n=new Array(w),r=e.substring(2);n=r.split(","),w>=1&&(t[0]=n[0].substring(3)),w>=2&&(t[1]=n[1].substring(3)),w>=3&&(t[2]=n[2].substring(3));for(i in t)switch(t[i]){case"natural":t[i]="♮";break;case"flat":t[i]="♭";break;case"sharp":t[i]="♯"}return t}function v(e){if("show"==n||"edit"==n||"new"==n)switch(e){case"keys":var t=String(w)+":"+y.ToString("keys");return w>=2&&(t+=","+x.ToString("keys")),w>=3&&(t+=","+b.ToString("keys")),t;case"note_tones":var t=String(w)+":"+y.ToString("note_tones");return w>=2&&(t+=","+x.ToString("note_tones")),w>=3&&(t+=","+b.ToString("note_tones")),t;default:return v("keys")}else if("note_search"==n){var t=String(w)+":"+T[0].ToString();return w>=2&&(t+=","+T[1].ToString()),w>=3&&(t+=","+T[2].ToString()),t}}var y,x,b,w,T=new Array(3),_=new Image,k=!1,C=!1,S=!1,M=!1,N=!1,E=r;if(this.Update=u,this.ToString=v,this.OnClick=d,w=e[0],"show"==n||"edit"==n||"new"==n){var P=new Array(w),I=new Array(w),A=new Array(w);P=h(e),I=m(t),A=g(t),scale_X=m_canvas.width/200,scale_Y=(m_canvas.height-100)/200,w>=1&&(y=new Fingering_Chart(0,0,P[0],I[0],A[0],!0,n)),w>=2&&(x=new Fingering_Chart(200,0,P[1],I[1],A[1],!1,n)),w>=3&&(b=new Fingering_Chart(400,0,P[2],I[2],A[2],!1,n))}else{if("note_search"!=n)return"fingering_search"==n?(alert("Warning: Not Implemented!"),!1):(alert("Error: Something went wrong with the canvas!"),!1);scale_X=m_canvas.width/200,scale_Y=m_canvas.height/75,w>=1&&(T[0]=new Note_Chart(0,0)),w>=2&&(T[1]=new Note_Chart(200,0)),w>=3&&(T[2]=new Note_Chart(400,0))}return _.src="/assets/other/legend-f0927f204811ceb0781b085ee2590671.png",m_ctx.canvas.width=w>1?200+200*scale_X*w:200*scale_X,isMobile()?m_canvas.onclick=d:(m_canvas.onclick=d,m_canvas.onmousemove=p),isMobile()?setInterval(u,250):(!function j(){requestAnimFrame(j),u()}(),void 0)}